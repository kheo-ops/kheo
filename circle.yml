machine:
  services:
    - docker

dependencies:
  pre:
    - cd kheo-api && mvn clean package -DskipTests && cd ..
    - cd kheo-web && npm install && bower install && grunt build && cd ..
  override:
    - docker build -t kheo-api kheo-api
    - docker pull dockerfile/nginx 
    - docker pull mongo:latest
  post:
    - ls -al

test:
  pre:
    - netstat -ntlp 
    - docker run -d -p 37017:27017 mongo:latest
    - docker run -d -p 8080:8080 -p 8081:8081 kheo-api
    - docker run -d -p 80:80 -v `pwd`/kheo-web/dist:/var/www/html dockerfile/nginx
  override:
    - sleep 10
